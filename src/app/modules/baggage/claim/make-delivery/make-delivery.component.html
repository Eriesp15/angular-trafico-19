<div class="make-delivery-container">
  <!-- Main Form Section -->
  <div class="delivery-form-section" *ngIf="!showConfirmation">
    <div class="form-header">
      <h1>Realizar Entrega</h1>
      <p class="subtitle">Reclamo #{{ claimId }}</p>
    </div>

    <form [formGroup]="deliveryForm" class="delivery-form">
      <!-- Tipo de Entrega: Solo 2 opciones -->
      <div class="form-section">
        <h2 class="section-title">Tipo de Entrega</h2>

        <div class="delivery-type-cards">
          <div 
            *ngFor="let type of deliveryTypes"
            class="delivery-type-card"
            [class.selected]="selectedDeliveryType === type.value"
            (click)="deliveryForm.get('tipo')?.setValue(type.value)"
          >
            <mat-icon>{{ type.icon }}</mat-icon>
            <span>{{ type.label }}</span>
          </div>
        </div>
      </div>

      <!-- Campos para Envío a Domicilio -->
      <div class="form-section" *ngIf="selectedDeliveryType === 'domicilio'">
        <h2 class="section-title">Datos de Envío a Domicilio</h2>

        <div class="form-group">
          <label for="direccion" class="form-label">Dirección Completa *</label>
          <textarea
            id="direccion"
            class="form-textarea"
            formControlName="direccion"
            placeholder="Ingrese la dirección completa de entrega"
            rows="3"
            [class.error]="isFieldRequired('direccion')"
          ></textarea>
          <span class="error-message" *ngIf="isFieldRequired('direccion')">
            La dirección es requerida
          </span>
        </div>

        <div class="form-group">
          <label for="telefono" class="form-label">Teléfono de Contacto *</label>
          <input
            id="telefono"
            type="tel"
            class="form-input"
            formControlName="telefono"
            placeholder="Ej: 77712345"
            [class.error]="isFieldRequired('telefono')"
          />
          <span class="error-message" *ngIf="isFieldRequired('telefono')">
            El teléfono es requerido
          </span>
        </div>

        <div class="form-group">
          <label for="referencia" class="form-label">Referencia (Opcional)</label>
          <input
            id="referencia"
            type="text"
            class="form-input"
            formControlName="referencia"
            placeholder="Cerca de..., frente a..."
          />
        </div>

        <div class="info-box warning">
          <mat-icon>local_shipping</mat-icon>
          <p>
            El envío a domicilio genera costos de transporte que serán registrados como gasto del reclamo.
          </p>
        </div>
      </div>

      <!-- Campos para Entrega en Aeropuerto -->
      <div class="form-section" *ngIf="selectedDeliveryType === 'aeropuerto'">
        <h2 class="section-title">Seleccionar Aeropuerto</h2>

        <div class="aeropuerto-grid">
          <div 
            *ngFor="let aeropuerto of aeropuertos"
            class="aeropuerto-card"
            [class.selected]="deliveryForm.get('aeropuerto')?.value === aeropuerto.codigo"
            (click)="deliveryForm.get('aeropuerto')?.setValue(aeropuerto.codigo)"
          >
            <div class="aeropuerto-codigo">{{ aeropuerto.codigo }}</div>
            <div class="aeropuerto-info">
              <span class="aeropuerto-ciudad">{{ aeropuerto.ciudad }}</span>
              <span class="aeropuerto-nombre">{{ aeropuerto.nombre }}</span>
            </div>
          </div>
        </div>

        <span class="error-message" *ngIf="isFieldRequired('aeropuerto')">
          Debe seleccionar un aeropuerto
        </span>

        <div class="info-box">
          <mat-icon>info</mat-icon>
          <p>
            El pasajero deberá presentar su documento de identidad y el comprobante de reclamo para recoger su equipaje.
          </p>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="form-actions">
        <button type="button" class="btn btn-cancel" (click)="cancelar()">
          <mat-icon>close</mat-icon>
          Cancelar
        </button>
        <button type="button" class="btn btn-accept" (click)="aceptar()" [disabled]="deliveryForm.invalid">
          <mat-icon>check</mat-icon>
          Continuar
        </button>
      </div>
    </form>
  </div>

  <!-- Confirmation Section -->
  <div class="confirmation-section" *ngIf="showConfirmation && confirmationData">
    <div class="confirmation-header">
      <h1>Confirmar Entrega</h1>
      <p class="subtitle">Revise los datos antes de confirmar</p>
    </div>

    <div class="confirmation-box">
      <div class="confirmation-item">
        <span class="label">Tipo de Entrega:</span>
        <span class="value highlight">{{ confirmationData.tipo }}</span>
      </div>

      <!-- Datos de domicilio -->
      <ng-container *ngIf="confirmationData.direccion">
        <div class="confirmation-item">
          <span class="label">Dirección:</span>
          <span class="value">{{ confirmationData.direccion }}</span>
        </div>
        <div class="confirmation-item">
          <span class="label">Teléfono:</span>
          <span class="value">{{ confirmationData.telefono }}</span>
        </div>
        <div class="confirmation-item" *ngIf="confirmationData.referencia">
          <span class="label">Referencia:</span>
          <span class="value">{{ confirmationData.referencia }}</span>
        </div>
      </ng-container>

      <!-- Datos de aeropuerto -->
      <ng-container *ngIf="confirmationData.aeropuerto">
        <div class="confirmation-item">
          <span class="label">Aeropuerto:</span>
          <span class="value">{{ confirmationData.aeropuerto }} - {{ confirmationData.nombreAeropuerto }}</span>
        </div>
      </ng-container>
    </div>

    <div class="confirmation-actions">
      <button type="button" class="btn btn-cancel" (click)="volver()">
        <mat-icon>arrow_back</mat-icon>
        Volver
      </button>
      <button type="button" class="btn btn-confirm" (click)="confirmarEntrega()">
        <mat-icon>done_all</mat-icon>
        Confirmar Entrega
      </button>
    </div>
  </div>
</div>
