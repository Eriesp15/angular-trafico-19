<div class="content-form-container">
  <div class="content-form">
    <!-- Header -->
    <div class="form-header">
      <div class="header-left">
        <div class="header-info">
          <h1>Formulario de Descripción de Contenido</h1>
          <p class="subtitle">Inventario detallado del equipaje - PIR {{ claimId }}</p>
          <span *ngIf="isConfirmed" class="badge-confirmed">
            ✓ FORMULARIO BLOQUEADO
          </span>
        </div>
      </div>
      <div class="header-actions">
        <button *ngIf="isViewMode && hasExistingData && !isConfirmed" class="btn btn-edit" (click)="enableEditMode()">
          <mat-icon>edit</mat-icon>
          Editar
        </button>
        <button *ngIf="isViewMode && !hasExistingData" class="btn btn-primary" (click)="enableEditMode()">
          <mat-icon>add</mat-icon>
          Completar
        </button>
        <div class="header-badges">
          <div class="badge-item">
            <span class="badge-label">Tipo Reclamo</span>
            <span class="badge-value type">{{ claimType || 'AHL' }}</span>
          </div>
          <div class="badge-item">
            <span class="badge-label">Fecha</span>
            <span class="badge-value">{{ claimDate || 'N/A' }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner"></div>
      <p>Cargando información del formulario...</p>
    </div>

    <!-- ==================== MODO VISTA (Solo Lectura) ==================== -->
    <div *ngIf="!isLoading && isViewMode && !showSummary" class="view-mode">
      
      <!-- Sin datos existentes -->
      <div *ngIf="!hasExistingData" class="empty-state">
        <mat-icon>description</mat-icon>
        <h3>Formulario de Contenido No Completado</h3>
        <p>El pasajero aún no ha llenado el formulario de descripción de contenido del equipaje.</p>
        <button class="btn btn-primary" (click)="enableEditMode()">
          <mat-icon>edit</mat-icon>
          Completar Formulario
        </button>
      </div>

      <!-- Con datos existentes - Vista estática -->
      <div *ngIf="hasExistingData && contentData">
        
        <!-- Sección: Información del Reclamo -->
        <div class="section info-section">
          <h2 class="section-title">
            <mat-icon>info</mat-icon>
            Información del Reclamo
          </h2>
          <div class="info-grid">
            <div class="info-item">
              <span class="info-label">Número PIR</span>
              <span class="info-value">{{ pirNumber || claimId }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">Pasajero</span>
              <span class="info-value">{{ passengerLastName }} / {{ passengerName }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">Ruta</span>
              <span class="info-value">{{ route || 'N/A' }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">Peso Registrado</span>
              <span class="info-value">{{ baggageWeight || '—' }} kg</span>
            </div>
          </div>
        </div>

        <!-- Sección: Aduana (Nueva) -->
        <div class="section aduana-section">
          <h2 class="section-title">
            <mat-icon>security</mat-icon>
            Información de Aduana
          </h2>
          <div class="view-grid">
            <div class="view-item">
              <span class="view-label">¿Pasó por Aduana?</span>
              <span class="view-value">{{ contentData.customsDeclared ? 'Sí' : 'No' }}</span>
            </div>
            <div class="view-item">
              <span class="view-label">Ciudad / Aeropuerto</span>
              <span class="view-value">{{ contentData.customsAirport || '—' }}</span>
            </div>
            <div class="view-item">
              <span class="view-label">¿Fue Embalado?</span>
              <span class="view-value">{{ contentData.packed ? 'Sí' : 'No' }}</span>
            </div>
            <div class="view-item">
              <span class="view-label">Código de Combinación</span>
              <span class="view-value">{{ contentData.combinationCode || '—' }}</span>
            </div>
            <div class="view-item">
              <span class="view-label">Ruedas</span>
              <span class="view-value">{{ contentData.wheels || '—' }}</span>
            </div>
            <div class="view-item">
              <span class="view-label">Manija Retráctil</span>
              <span class="view-value">{{ contentData.retractablePuller ? 'Sí' : 'No' }}</span>
            </div>
          </div>
        </div>

        <!-- Sección: Descripción del Equipaje (Vista) -->
        <div class="section">
          <h2 class="section-title">
            <mat-icon>luggage</mat-icon>
            Descripción del Equipaje
          </h2>
          <div class="view-grid">
            <div class="view-item">
              <span class="view-label">Tipo de Equipaje</span>
              <span class="view-value">{{ getBaggageTypeLabel(contentData.baggageType) }}</span>
            </div>
            <div class="view-item">
              <span class="view-label">Color Principal</span>
              <span class="view-value">{{ getBaggageColorLabel(contentData.baggageColor) }}</span>
            </div>
            <div class="view-item">
              <span class="view-label">Marca</span>
              <span class="view-value">{{ contentData.baggageBrand || '—' }}</span>
            </div>
            <div class="view-item">
              <span class="view-label">Tamaño</span>
              <span class="view-value">{{ getBaggageSizeLabel(contentData.baggageSize) }}</span>
            </div>
            <div class="view-item full-width">
              <span class="view-label">Descripción Adicional</span>
              <span class="view-value">{{ contentData.baggageDescription || '—' }}</span>
            </div>
          </div>

          <!-- Control de Peso (Vista) -->
          <div class="weight-display">
            <h3>Control de Peso (BW / DW)</h3>
            <div class="weight-boxes">
              <div class="weight-box">
                <span class="weight-label">Peso Facturado (BW)</span>
                <span class="weight-value">{{ baggageWeight || '—' }} kg</span>
              </div>
              <div class="weight-box">
                <span class="weight-label">Peso Entregado (DW)</span>
                <span class="weight-value">{{ contentData.deliveredWeight || '—' }} kg</span>
              </div>
              <div class="weight-box difference" [class.has-difference]="contentData.weightDifference && +contentData.weightDifference > 0">
                <span class="weight-label">Diferencia</span>
                <span class="weight-value">{{ contentData.weightDifference || '0' }} kg</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Sección: Contenido del Equipaje (Vista) -->
        <div class="section">
          <h2 class="section-title">
            <mat-icon>inventory_2</mat-icon>
            Contenido del Equipaje
          </h2>
          
          <div class="content-table" *ngIf="contentData.contentItems && contentData.contentItems.length > 0">
            <table>
              <thead>
                <tr>
                  <th>#</th>
                  <th>Categoría</th>
                  <th>Descripción</th>
                  <th>Cantidad</th>
                  <th>Color</th>
                  <th>Marca</th>
                  <th>Valor Aprox.</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of contentData.contentItems; let i = index">
                  <td>{{ i + 1 }}</td>
                  <td>{{ getCategoryLabel(item.category) }}</td>
                  <td>{{ item.description || '—' }}</td>
                  <td class="center">{{ item.quantity }}</td>
                  <td>{{ item.color || '—' }}</td>
                  <td>{{ item.brand || '—' }}</td>
                  <td class="right">{{ item.approximateValue ? '$' + item.approximateValue : '—' }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div *ngIf="!contentData.contentItems || contentData.contentItems.length === 0" class="no-data">
            <mat-icon>inbox</mat-icon>
            <span>No se registró contenido</span>
          </div>
        </div>

        <!-- Sección: Información Adicional (Vista) -->
        <div class="section">
          <h2 class="section-title">
            <mat-icon>search</mat-icon>
            Información Adicional para Búsqueda
          </h2>
          <div class="view-grid">
            <div class="view-item full-width">
              <span class="view-label">Marcas Distintivas Externas</span>
              <span class="view-value">{{ contentData.distinctiveMarks || '—' }}</span>
            </div>
            <div class="view-item">
              <span class="view-label">Tipo de Candado/Cierre</span>
              <span class="view-value">{{ getLockTypeLabel(contentData.lockType) }}</span>
            </div>
            <div class="view-item">
              <span class="view-label">Tiene las Llaves</span>
              <span class="view-value">{{ contentData.hasKeys ? 'Sí' : 'No' }}</span>
            </div>
            <div class="view-item full-width">
              <span class="view-label">Notas Adicionales</span>
              <span class="view-value">{{ contentData.additionalNotes || '—' }}</span>
            </div>
          </div>
        </div>

        <!-- Acciones Vista -->
        <div class="form-actions">
          <div class="actions-left">
            <button class="btn btn-outline" (click)="goBack()">
              <mat-icon>arrow_back</mat-icon>
              Volver al PIR
            </button>
          </div>
          <div class="actions-right">
            <button class="btn btn-secondary" (click)="printForm()">
              <mat-icon>print</mat-icon>
              Imprimir
            </button>
            <button *ngIf="!isConfirmed" class="btn btn-edit" (click)="enableEditMode()">
              <mat-icon>edit</mat-icon>
              Editar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ==================== MODO EDICIÓN ==================== -->
    <form *ngIf="!isLoading && !isViewMode" [formGroup]="contentForm" (ngSubmit)="onSubmit()" class="edit-mode">
      
      <!-- Sección: Información del Reclamo (Solo lectura) -->
      <div class="section info-section">
        <h2 class="section-title">
          <mat-icon>info</mat-icon>
          Información del Reclamo
        </h2>
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">Número PIR</span>
            <span class="info-value">{{ pirNumber || claimId }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Pasajero</span>
            <span class="info-value">{{ passengerLastName }} / {{ passengerName }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Ruta</span>
            <span class="info-value">{{ route || 'N/A' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Peso Registrado</span>
            <span class="info-value">{{ baggageWeight || '—' }} kg</span>
          </div>
        </div>
      </div>

      <!-- Sección: Aduana y Empaque (NUEVA) -->
      <div formGroupName="aduana" class="section aduana-section">
        <h2 class="section-title">
          <mat-icon>security</mat-icon>
          Aduana y Empaque
        </h2>
        <p class="section-subtitle">Por favor, indica los detalles relacionados al paso por aduana y el estado del equipaje.</p>

        <div class="form-grid">
          <div class="form-group">
            <label>¿Pasó por aduana?</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" value="Si" formControlName="didAduana" [disabled]="isConfirmed">
                Sí
              </label>
              <label class="radio-label">
                <input type="radio" value="No" formControlName="didAduana" [disabled]="isConfirmed">
                No
              </label>
            </div>
          </div>

          <div class="form-group">
            <label for="cityOrAirport">Ciudad o Aeropuerto</label>
            <input type="text" id="cityOrAirport" formControlName="cityOrAirport" 
              placeholder="Ej: Madrid o JFK" [disabled]="isConfirmed">
          </div>

          <div class="form-group">
            <label>¿El equipaje fue embalado?</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" value="Si" formControlName="packed" [disabled]="isConfirmed">
                Sí
              </label>
              <label class="radio-label">
                <input type="radio" value="No" formControlName="packed" [disabled]="isConfirmed">
                No
              </label>
            </div>
          </div>

          <div class="form-group">
            <label for="combinationCode">Código de Combinación</label>
            <input type="text" id="combinationCode" formControlName="combinationCode" 
              placeholder="Ej: 123" [disabled]="isConfirmed">
          </div>

          <div class="form-group">
            <label for="wheels">Ruedas</label>
            <select id="wheels" formControlName="wheels" [disabled]="isConfirmed">
              <option *ngFor="let w of wheelsOptions">{{ w }}</option>
            </select>
          </div>

          <div class="form-group checkbox-group inline">
            <input type="checkbox" id="retractableHandle" formControlName="retractableHandle" [disabled]="isConfirmed">
            <label for="retractableHandle">Manija retráctil</label>
          </div>
        </div>
      </div>

      <!-- Sección: Descripción del Equipaje -->
      <div formGroupName="equipaje" class="section">
        <h2 class="section-title">
          <mat-icon>luggage</mat-icon>
          Características del Equipaje
        </h2>
        <p class="section-subtitle">Complete la descripción física del equipaje reclamado</p>

        <div class="form-grid">
          <div class="form-group">
            <label for="baggageType">Tipo de Equipaje *</label>
            <select id="baggageType" formControlName="baggageType" [disabled]="isConfirmed">
              <option value="">Seleccione...</option>
              <option value="01">01 - Maleta Dura (Hard Case)</option>
              <option value="02">02 - Maleta Semi-Dura</option>
              <option value="03">03 - Maleta Suave (Soft Case)</option>
              <option value="04">04 - Bolso de Viaje</option>
              <option value="05">05 - Mochila</option>
              <option value="06">06 - Caja/Cartón</option>
              <option value="22">22 - Bolso Deportivo</option>
              <option value="25">25 - Maletín/Portafolio</option>
              <option value="27">27 - Maleta Expandible</option>
              <option value="99">99 - Otro</option>
            </select>
          </div>

          <div class="form-group">
            <label for="baggageColor">Color Principal *</label>
            <select id="baggageColor" formControlName="baggageColor" [disabled]="isConfirmed">
              <option value="">Seleccione...</option>
              <option value="BK">BK - Negro</option>
              <option value="BU">BU - Azul</option>
              <option value="GY">GY - Gris</option>
              <option value="RD">RD - Rojo</option>
              <option value="GN">GN - Verde</option>
              <option value="BN">BN - Marrón/Café</option>
              <option value="WT">WT - Blanco</option>
              <option value="YW">YW - Amarillo</option>
              <option value="OR">OR - Naranja</option>
              <option value="PK">PK - Rosa</option>
              <option value="PR">PR - Púrpura</option>
              <option value="MC">MC - Multicolor</option>
            </select>
          </div>

          <div class="form-group">
            <label for="baggageBrand">Marca</label>
            <input type="text" id="baggageBrand" formControlName="baggageBrand" 
              placeholder="Ej: Samsonite" [disabled]="isConfirmed">
          </div>

          <div class="form-group">
            <label for="baggageSize">Tamaño</label>
            <select id="baggageSize" formControlName="baggageSize" [disabled]="isConfirmed">
              <option value="">Seleccione...</option>
              <option value="S">Pequeño (Cabin Size)</option>
              <option value="M">Mediano (23-25")</option>
              <option value="L">Grande (26-29")</option>
              <option value="XL">Extra Grande (30"+)</option>
            </select>
          </div>

          <div class="form-group full-width">
            <label for="baggageDescription">Descripción Adicional *</label>
            <textarea id="baggageDescription" formControlName="baggageDescription" 
              placeholder="Describa características distintivas: stickers, cintas, rayones, marcas visibles, etc." 
              rows="2" [disabled]="isConfirmed"></textarea>
          </div>
        </div>

        <!-- Control de Peso -->
        <div class="weight-control">
          <h3>Control de Peso (BW / DW)</h3>
          <div class="weight-grid">
            <div class="weight-item">
              <label>Peso Facturado (BW)</label>
              <div class="input-with-unit">
                <input type="number" formControlName="registeredWeight" readonly>
                <span class="unit">kg</span>
              </div>
            </div>
            <div class="weight-item">
              <label>Peso Entregado (DW)</label>
              <div class="input-with-unit">
                <input type="number" formControlName="deliveredWeight" 
                  (change)="calculateWeightDifference()" [disabled]="isConfirmed">
                <span class="unit">kg</span>
              </div>
            </div>
            <div class="weight-item difference">
              <label>Diferencia</label>
              <div class="input-with-unit">
                <input type="text" formControlName="weightDifference" readonly>
                <span class="unit">kg</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Sección: Contenido del Equipaje -->
      <div class="section">
        <h2 class="section-title">
          <mat-icon>inventory_2</mat-icon>
          Detalle de Ítems
        </h2>
        <p class="section-subtitle">Registra los objetos ubicados dentro del equipaje (mínimo 1).</p>

        <div formArrayName="contentItems" class="content-items">
          <div *ngFor="let item of contentItems.controls; let i = index" [formGroupName]="i"
            class="content-item-card">
            <div class="item-header">
              <span class="item-number">Artículo {{ i + 1 }}</span>
              <button type="button" class="remove-btn" (click)="removeContentItem(i)" 
                *ngIf="!isConfirmed && contentItems.length > 1">
                <mat-icon>close</mat-icon>
              </button>
            </div>
            <div class="item-form-grid">
              <div class="form-group">
                <label>Nombre/Descripción *</label>
                <input type="text" formControlName="description" placeholder="Ítem/Artículo" [disabled]="isConfirmed">
              </div>
              <div class="form-group">
                <label>Categoría *</label>
                <select formControlName="category" [disabled]="isConfirmed">
                  <option value="">Seleccione...</option>
                  <option *ngFor="let cat of categories" [value]="cat.code">{{ cat.label }}</option>
                </select>
              </div>
              <div class="form-group small">
                <label>Cantidad</label>
                <input type="number" formControlName="quantity" min="1" placeholder="1" [disabled]="isConfirmed">
              </div>
              <div class="form-group">
                <label>Tamaño</label>
                <input type="text" formControlName="color" placeholder="Tamaño/Descripción" [disabled]="isConfirmed">
              </div>
              <div class="form-group">
                <label>Marca</label>
                <input type="text" formControlName="brand" placeholder="Marca" [disabled]="isConfirmed">
              </div>
              <div class="form-group">
                <label>Valor Aprox.</label>
                <input type="text" formControlName="approximateValue" placeholder="Valor" [disabled]="isConfirmed">
              </div>
            </div>
          </div>

          <button type="button" class="add-item-btn" (click)="addContentItem()" 
            *ngIf="!isConfirmed && contentItems.length < maxItems">
            <mat-icon>add</mat-icon>
            Agregar Ítem
          </button>
        </div>
      </div>

      <!-- Sección: Información Adicional -->
      <div class="section">
        <h2 class="section-title">
          <mat-icon>search</mat-icon>
          Información Adicional para Búsqueda
        </h2>

        <div class="form-grid">
          <div class="form-group full-width">
            <label for="distinctiveMarks">Marcas Distintivas Externas</label>
            <textarea id="distinctiveMarks" formControlName="distinctiveMarks" 
              placeholder="Rayones, stickers, cintas, etiquetas, etc." 
              rows="2" [disabled]="isConfirmed"></textarea>
          </div>

          <div class="form-group">
            <label for="lockType">Tipo de Candado/Cierre</label>
            <select id="lockType" formControlName="lockType" [disabled]="isConfirmed">
              <option value="">Seleccione...</option>
              <option value="NONE">Sin candado</option>
              <option value="KEY">Candado con llave</option>
              <option value="COMBINATION">Candado de combinación</option>
              <option value="TSA">Candado TSA</option>
              <option value="INTEGRATED">Cerradura integrada</option>
              <option value="ZIPPER">Solo cierre/cremallera</option>
            </select>
          </div>

          <div class="form-group checkbox-group">
            <input type="checkbox" id="hasKeys" formControlName="hasKeys" [disabled]="isConfirmed">
            <label for="hasKeys">Tiene las llaves</label>
          </div>

          <div class="form-group full-width">
            <label for="additionalNotes">Notas Adicionales</label>
            <textarea id="additionalNotes" formControlName="additionalNotes" 
              placeholder="Información adicional relevante para la búsqueda" 
              rows="2" [disabled]="isConfirmed"></textarea>
          </div>
        </div>
      </div>

      <!-- Sección: Declaración -->
      <div class="section">
        <h2 class="section-title">
          <mat-icon>draw</mat-icon>
          Declaración del Pasajero
        </h2>

        <div class="declaration-box">
          <div class="checkbox-declaration">
            <input type="checkbox" id="passengerDeclaration" formControlName="passengerDeclaration" [disabled]="isConfirmed">
            <label for="passengerDeclaration">
              <strong>DECLARO</strong> que la información proporcionada en este formulario es completa y veraz. 
              Entiendo que Boliviana de Aviación no se responsabiliza por artículos de valor en equipaje facturado.
            </label>
          </div>
        </div>

        <div class="form-grid">
          <div class="form-group full-width">
            <label for="passengerSignature">Firma del Pasajero *</label>
            <input type="text" id="passengerSignature" formControlName="passengerSignature" 
              placeholder="Nombre o firma" [disabled]="isConfirmed">
          </div>

          <div class="form-group">
            <label for="signatureDate">Fecha de Firma *</label>
            <input type="date" id="signatureDate" formControlName="signatureDate" [disabled]="isConfirmed">
          </div>
        </div>
      </div>

      <!-- Botones de Acción (Edición) -->
      <div class="form-actions">
        <div class="actions-left">
          <button type="button" class="btn btn-outline" (click)="cancelEdit()" [disabled]="isConfirmed">
            <mat-icon>cancel</mat-icon>
            Cancelar
          </button>
        </div>
        <div class="actions-right">
          <button type="submit" class="btn btn-primary" [disabled]="isConfirmed || isSaving">
            <mat-icon>{{ isSaving ? 'hourglass_empty' : 'check' }}</mat-icon>
            {{ isSaving ? 'Guardando...' : 'Enviar para Revisión' }}
          </button>
        </div>
      </div>
    </form>

    <!-- ============ MODAL DE RESUMEN ============ -->
    <div *ngIf="showSummary && !isConfirmed" class="summary-modal-overlay" (click)="backToForm()">
      <div class="summary-modal" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h1>Resumen del Formulario Contenido</h1>
          <button type="button" class="close-btn" (click)="backToForm()">
            <mat-icon>close</mat-icon>
          </button>
        </div>

        <p class="modal-warning">
          <mat-icon>warning</mat-icon>
          ¡IMPORTANTE! Revisa la información. Al confirmar, el formulario se bloqueará.
        </p>

        <div class="summary-content">
          <!-- Resumen Aduana -->
          <div class="summary-section">
            <h2>Detalles de Aduana</h2>
            <div class="summary-grid">
              <div><strong>¿Pasó por aduana?:</strong> {{ contentForm.get('aduana.didAduana')?.value }}</div>
              <div><strong>Ciudad o Aeropuerto:</strong> {{ contentForm.get('aduana.cityOrAirport')?.value || 'No especificado' }}</div>
              <div><strong>¿Fue embalado?:</strong> {{ contentForm.get('aduana.packed')?.value }}</div>
              <div><strong>Código de Combinación:</strong> {{ contentForm.get('aduana.combinationCode')?.value || '—' }}</div>
              <div><strong>Ruedas:</strong> {{ contentForm.get('aduana.wheels')?.value || '—' }}</div>
              <div><strong>Manija retráctil:</strong> {{ contentForm.get('aduana.retractableHandle')?.value ? 'Sí' : 'No' }}</div>
            </div>
          </div>

          <!-- Resumen Equipaje -->
          <div class="summary-section">
            <h2>Características del Equipaje</h2>
            <div class="summary-grid">
              <div><strong>Tipo:</strong> {{ getBaggageTypeLabel(contentForm.get('equipaje.baggageType')?.value) }}</div>
              <div><strong>Color:</strong> {{ getBaggageColorLabel(contentForm.get('equipaje.baggageColor')?.value) }}</div>
              <div><strong>Marca:</strong> {{ contentForm.get('equipaje.baggageBrand')?.value || '—' }}</div>
              <div><strong>Tamaño:</strong> {{ getBaggageSizeLabel(contentForm.get('equipaje.baggageSize')?.value) }}</div>
              <div><strong>Descripción:</strong> {{ contentForm.get('equipaje.baggageDescription')?.value || '—' }}</div>
            </div>
          </div>

          <!-- Resumen Ítems -->
          <div class="summary-section">
            <h2>Ítems Registrados ({{ contentItems.length }})</h2>
            <div class="summary-table">
              <table>
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Descripción</th>
                    <th>Categoría</th>
                    <th>Cantidad</th>
                    <th>Tamaño</th>
                    <th>Marca</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of contentItems.controls; let i = index">
                    <td>{{ i + 1 }}</td>
                    <td>{{ (item.get('description')?.value || '—') }}</td>
                    <td>{{ getCategoryLabel(item.get('category')?.value) }}</td>
                    <td class="center">{{ item.get('quantity')?.value || 1 }}</td>
                    <td>{{ item.get('color')?.value || '—' }}</td>
                    <td>{{ item.get('brand')?.value || '—' }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="modal-actions">
          <button type="button" class="btn btn-outline" (click)="backToForm()">
            <mat-icon>arrow_back</mat-icon>
            Volver a Editar
          </button>
          <button type="button" class="btn btn-primary" (click)="confirmSummary()" [disabled]="isSaving">
            <mat-icon>{{ isSaving ? 'hourglass_empty' : 'check_circle' }}</mat-icon>
            {{ isSaving ? 'Guardando...' : 'Confirmar y Bloquear' }}
          </button>
          <button type="button" class="btn btn-secondary" (click)="printSummary()">
            <mat-icon>print</mat-icon>
            Imprimir
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
