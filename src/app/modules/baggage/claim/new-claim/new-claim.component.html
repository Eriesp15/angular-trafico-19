<div class="realizar-reclamo-container">
  <div class="header">
    <h1>Formulario PIR - Boliviana de Aviación</h1>
    <p class="subtitle">Registro de Incidente del Pasajero (PIR)</p>

    <!-- Added format selector tabs -->
    <div class="format-selector">
      <button
        class="format-tab"
        [class.active]="pirFormat === 'classic'"
        (click)="switchFormat('classic')"
      >
        PIR Clásico
      </button>
      <button
        class="format-tab"
        [class.active]="pirFormat === 'modern'"
        (click)="switchFormat('modern')"
      >
        PIR Prototipo
      </button>
    </div>
  </div>

  <div class="content">
    <!-- PIR CLASSIC FORMAT -->
    <div *ngIf="pirFormat === 'classic'" class="pir-classic">
      <!-- Line 1: Estaciones involucradas -->
      <div class="section">
        <h2 class="section-title">Estaciones Involucradas</h2>
        <div class="form-group">
          <label>Prioridad de Estación > Dirección(es)</label>
          <!-- Nueva estructura con código fuera y botón a la izquierda -->
          <div class="multi-field-wrapper">
            <span class="code">QD</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addInvolvedStation()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let station of claimData.involvedStations; let i = index">
                  <input
                    type="text"
                    [(ngModel)]="claimData.involvedStations[i]"
                    placeholder="Ej: VVILLOB"
                  />
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeInvolvedStation(i)"
                    *ngIf="claimData.involvedStations.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Line 2: Originador/Date/Time -->
      <div class="section">
        <div class="form-grid-3">
          <div class="form-group">
            <label>Originador</label>
            <input type="text" [(ngModel)]="claimData.originStation" />
          </div>
          <div class="form-group">
            <label>Fecha</label>
            <input type="date" [(ngModel)]="claimData.originatorDate" />
          </div>
          <div class="form-group">
            <label>Hora</label>
            <input type="time" [(ngModel)]="claimData.originatorTime" />
          </div>
          <div class="form-group">
            <label>Tipo reclamo</label>
            <div class="claim-type-buttons">
              <button
                type="button"
                [class.active]="claimData.claimType === 'AHL'"
                (click)="claimData.claimType = 'AHL'"
              >
                AHL
              </button>
              <button
                type="button"
                [class.active]="claimData.claimType === 'DAMAGED'"
                (click)="claimData.claimType = 'DAMAGED'"
              >
                DAMAGED
              </button>
              <button
                type="button"
                [class.active]="claimData.claimType === 'PILFERED'"
                (click)="claimData.claimType = 'PILFERED'"
              >
                PILFERED
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Line 3: Airport/Airline/Reference -->
      <div class="section">
        <div class="form-grid-3">
          <div class="form-group">
            <label>Aeropuerto</label>
              <input type="text" [(ngModel)]="claimData.airport" />
          </div>
          <div class="form-group">
            <label>Aerolínea</label>
              <input type="text" [(ngModel)]="claimData.airline" />
          </div>
          <div class="form-group">
            <label>Referencia</label>
              <input type="text" [(ngModel)]="claimData.reference" />
          </div>
        </div>
      </div>

      <div class="section">
        <h2 class="section-title"> Apellido y Nombre del Pasajero en la maleta</h2>
        <div class="form-grid-3">
          <div class="form-group">
            <label>Apellido Paterno</label>            
            <div class="input-with-code">
              <span class="code">NM</span>
            <input type="text" [(ngModel)]="passengerData.paternalLastName" />
            </div>
          </div>
          <div class="form-group">
            <label>Apellido Materno</label>
            <input type="text" [(ngModel)]="passengerData.maternalLastName" />
          </div>
          <div class="form-group">
            <label>Nombre(s) (máximo 3 nombres)</label>

              <input type="text" [(ngModel)]="passengerData.firstName" />
          </div>
        </div>
      </div>

      <!-- Line 5: Initials -->
      <div class="section">
        <div class="form-group">
          <label>Iniciales en el equipaje del pasajero</label>
          <div class="input-with-code">
            <span class="code">IT</span>
            <input type="text" [(ngModel)]="passengerData.initials" />
          </div>
        </div>
      </div>

      <!-- Line 6: Ticket/BagTag -->
      <div class="section">
        <div class="form-group">
          <label>Número de ticket/Carrier Bag-Tag Number</label>
          <!-- Nueva estructura con código fuera y botón a la izquierda -->
          <div class="multi-field-wrapper">
            <span class="code">TN</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addBagtag()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let bagtag of baggageData.bagtags; let i = index">
                  <input
                    type="text"
                    [(ngModel)]="baggageData.bagtags[i]"
                    placeholder="Número de maleta"
                  />
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeBagtag(i)"
                    *ngIf="baggageData.bagtags.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Line 7: Color/Type/Description - Dynamic -->
      <div class="section">
        <div class="form-group">
          <label>Color/Tipo/Descripción por Maleta</label>
          <!-- Nueva estructura con código fuera y botón a la izquierda -->
          <div class="multi-field-wrapper">
            <span class="code">CT</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addColor()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let color of baggageData.colors; let i = index">
                  <input
                    type="text"
                    [(ngModel)]="baggageData.colors[i].color"
                    placeholder="Color/tipo/descripción"
                  />
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeColor(i)"
                    *ngIf="baggageData.colors.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Line 8: Tracking Route - Dynamic -->
      <div class="section">
        <div class="form-group">
          <label>Ruta y/o Lugar para Rastreo</label>
          <!-- Nueva estructura con código fuera y botón a la izquierda -->
          <div class="multi-field-wrapper">
            <span class="code">RT</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addRoute()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let route of baggageData.routes; let i = index">
                  <input
                    type="text"
                    [(ngModel)]="baggageData.routes[i]"
                    placeholder="Ruta de rastreo"
                  />
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeRoute(i)"
                    *ngIf="baggageData.routes.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Line 9: Flight/Date - Dynamic -->
      <!-- Estructura mejorada para vuelos con día y mes independientes -->
      <div class="section">
        <div class="form-group">
          <label>Información de Vuelos</label>
          <div class="multi-field-wrapper">
            <span class="code">FD</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addFlightInfo()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item flight-item" *ngFor="let flight of baggageData.flightInfo; let i = index">
                  <div class="flight-fields">
                    <input
                      type="text"
                      [(ngModel)]="baggageData.flightInfo[i].flightNumber"
                      placeholder="Número de vuelo"
                      class="flight-number"
                    />
                    <input
                      type="text"
                      [(ngModel)]="baggageData.flightInfo[i].day"
                      placeholder="Día"
                      class="flight-day"
                    />
                    <input
                      type="text"
                      [(ngModel)]="baggageData.flightInfo[i].month"
                      placeholder="Mes"
                      class="flight-month"
                    />
                  </div>
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeFlightInfo(i)"
                    *ngIf="baggageData.flightInfo.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Line 10: Baggage Brand - Dynamic -->
      <div class="section">
        <div class="form-group">
          <label>Marca/Identificación Exterior</label>
          <!-- Nueva estructura con código fuera y botón a la izquierda -->
          <div class="multi-field-wrapper">
            <span class="code">BI</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addBrand()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let brand of baggageData.brands; let i = index">
                  <input
                    type="text"
                    [(ngModel)]="baggageData.brands[i]"
                    placeholder="Marca de maleta"
                  />
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeBrand(i)"
                    *ngIf="baggageData.brands.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Line 11: Content - Dynamic -->
      <div class="section">
        <div class="form-group">
          <label>Descripción del Contenido (no más de 4 artículos distintos)</label>
          <!-- Nueva estructura con código fuera y botón a la izquierda -->
          <div class="multi-field-wrapper">
            <span class="code">CC</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addContent()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let content of baggageData.contents; let i = index">
                  <textarea
                    [(ngModel)]="baggageData.contents[i]"
                    rows="2"
                    placeholder="Contenido de maleta"
                  ></textarea>
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeContent(i)"
                    *ngIf="baggageData.contents.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Line 12: Permanent Address -->
      <div class="section">
        <div class="form-group">
          <label>Dirección Permanente del Pasajero</label>
          <!-- Añadido clase textarea-large para hacerlo más ancho y visible -->
          <div class="input-with-code">
            <span class="code">PA</span>
            <textarea
              [(ngModel)]="passengerData.permanentAddress"
              rows="3"
              class="textarea-large"
            ></textarea>
          </div>
        </div>
      </div>

      <!-- Line 13: Temporary Address -->
      <div class="section">
        <div class="form-group">
          <label>Dirección Temporal del Pasajero</label>
          <!-- Añadido clase textarea-large para hacerlo más ancho y visible -->
          <div class="input-with-code">
            <span class="code">TA</span>
            <textarea
              [(ngModel)]="passengerData.temporaryAddress"
              rows="3"
              class="textarea-large"
            ></textarea>
          </div>
        </div>
      </div>

      <!-- Line 14: Phone/Delivery Instructions -->
      <div class="section">
        <div class="form-grid-3">
          <div class="form-group">
            <label>Teléfono Permanente del Pasajero</label>
            <div class="input-with-code">
              <span class="code">PN</span>
              <input type="text" [(ngModel)]="passengerData.permanentPhone" />
            </div>
          </div>
          <div class="form-group">
            <label>Teléfono Temporal</label>
            <div class="input-with-code">
              <span class="code">TP</span>
              <input type="text" [(ngModel)]="passengerData.temporaryPhone" />
            </div>
          </div>
        </div>
        <div class="form-group">
          <label>Instrucciones de Entrega</label>
          <!-- Añadido clase textarea-large para hacerlo más ancho y visible -->
          <div class="input-with-code">
            <span class="code">LD</span>
            <textarea
              [(ngModel)]="passengerData.deliveryInstructions"
              rows="3"
              class="textarea-large"
            ></textarea>
          </div>
        </div>
      </div>

      <!-- Line 15: Free Text -->
      <div class="section">
        <div class="form-group">
          <label>Texto libre</label>
          <!-- Añadido clase textarea-large para hacerlo más ancho y visible -->
          <div class="input-with-code">
            <span class="code">FF</span>
            <textarea rows="3" class="textarea-large"></textarea>
          </div>
        </div>
      </div>

      <!-- Line 16: Additional Elements -->
      <div class="section">
        <h2 class="section-title">Elementos Adicionales</h2>
        <div class="form-grid-3">
          <div class="form-group">
            <label>Peso del Equipaje Facturado</label>
            <div class="input-with-code">
              <span class="code">BW</span>
              <input type="text" [(ngModel)]="baggageData.bagWeight" />
            </div>
          </div>
          <div class="form-group">
            <label>Peso Entregado</label>
            <div class="input-with-code">
              <span class="code">DW</span>
              <input type="text" [(ngModel)]="baggageData.deliveredWeight" />
            </div>
          </div>
          <div class="form-group">
            <label>Diferencia de Peso</label>
            <div class="input-with-code">
              <span class="code">MW</span>
              <input type="text" [(ngModel)]="baggageData.weightDifference" />
            </div>
          </div>
        </div>
        <div class="form-grid-2">
          <div class="form-group">
            <label>Idioma</label>
            <!-- Cambiado select a input de texto libre -->
            <div class="input-with-code">
              <span class="code">LA</span>
              <input
                type="text"
                [(ngModel)]="additionalData.language"
                placeholder="Ingrese idioma"
              />
            </div>
          </div>
          <div class="form-group">
            <label>Número de Pasaporte</label>
            <div class="input-with-code">
              <span class="code">PP</span>
              <input type="text" [(ngModel)]="passengerData.passportNumber" />
            </div>
          </div>
        </div>
      </div>

      <!-- Line 17: Ticket/PNR/Frequent Traveler -->
      <div class="section">
        <div class="form-grid-3">
          <div class="form-group">
            <label>Número de Boleto</label>
            <div class="input-with-code">
              <span class="code">TK</span>
              <input type="text" [(ngModel)]="passengerData.ticketNumber" />
            </div>
          </div>
          <div class="form-group">
            <label>Localizador PNR</label>
            <div class="input-with-code">
              <span class="code">RL</span>
              <input type="text" [(ngModel)]="baggageData.pnrLocator" />
            </div>
          </div>
          <div class="form-group">
            <label>Identificación Viajero Frecuente</label>
            <div class="input-with-code">
              <span class="code">FR</span>
              <input type="text" [(ngModel)]="passengerData.frequentTravelerId" />
            </div>
          </div>
        </div>
      </div>

      <!-- Line 18: Email -->
      <div class="section">
        <div class="form-group">
          <label>Correo Electrónico del Pasajero</label>
          <div class="input-with-code">
            <span class="code">EM</span>
            <input type="email" [(ngModel)]="passengerData.email" />
          </div>
        </div>
      </div>

      <!-- Line 19: Loss Reason -->
      <div class="section">
        <div class="form-grid-2">
          <div class="form-group">
            <label>Razón de Pérdida</label>
            <!-- Cambiado select a input de texto libre -->
            <div class="input-with-code">
              <span class="code">LR</span>
              <input
                type="text"
                [(ngModel)]="baggageData.lossReason"
                placeholder="Ingrese razón de pérdida"
              />
            </div>
          </div>
          <div class="form-group">
            <label>Estación de Falla</label>
            <div class="input-with-code">
              <span class="code">FS</span>
              <input type="text" [(ngModel)]="baggageData.failureStation" />
            </div>
          </div>
        </div>
      </div>

      <!-- Damage Section -->
      <div class="section" *ngIf="claimData.claimType === 'DAMAGED'">
        <h2 class="section-title">Descripción del Daño</h2>

        <div class="damage-description-static">
          <h3>Partes Dañadas</h3>
          <div class="damage-parts-display">
            <div class="damage-part-card" *ngFor="let part of damageParts">
              <input
                type="checkbox"
                [id]="'part-' + part.code"
                [(ngModel)]="part.selected"
              />
              <label [for]="'part-' + part.code">
                <span class="part-code">{{ part.code }}</span>
                <span class="part-name">{{ part.name }}</span>
              </label>
            </div>
          </div>
        </div>

        <div class="form-group" style="margin-top: 1.5rem;">
          <label>Ubicación del Daño</label>
          <button
            type="button"
            class="btn-indicate-damage"
            (click)="openDamageLocationModal()"
          >
            Indicar Ubicación del Daño
          </button>
          <div *ngIf="selectedDamageLocations.length > 0" style="margin-top: 1rem;">
            <strong>Ubicaciones seleccionadas:</strong> {{ selectedDamageLocations.join(', ') }}
          </div>
        </div>

        <div class="form-group">
          <label>Tipo de Daño</label>
          <select [(ngModel)]="additionalData.damageType">
            <option value="">Seleccionar tipo</option>
            <option value="TORN">Rasgado</option>
            <option value="BROKEN">Roto</option>
            <option value="SCRATCHED">Rayado</option>
            <option value="DENTED">Abollado</option>
          </select>
        </div>

        <div class="form-group">
          <label>Condición del Daño</label>
          <select [(ngModel)]="additionalData.damageCondition">
            <option value="">Seleccionar condición</option>
            <option value="MINOR">Menor</option>
            <option value="MODERATE">Moderado</option>
            <option value="SEVERE">Severo</option>
          </select>
        </div>
      </div>
 <!-- Line 19: Insurance/Keys/Kit -->
      <div class="section">
        <div class="form-grid-3">
          <div class="form-group">
            <label>Seguro</label>
            <select [(ngModel)]="additionalData.hasInsurance">
              <option [value]="false">No</option>
              <option [value]="true">Sí</option>
            </select>
          </div>
          <div class="form-group">
            <label>Necesita Llave</label>
            <select [(ngModel)]="additionalData.needsKey">
              <option [value]="false">No</option>
              <option [value]="true">Sí</option>
            </select>
          </div>
          <div class="form-group">
            <label>Kit de Noche</label>
            <select [(ngModel)]="additionalData.kitType">
              <option value="">Ninguno</option>
              <option value="M">Hombre</option>
              <option value="F">Mujer</option>
            </select>
          </div>
        </div>
      </div>

     <!-- Line 20-21: Damage Info - STATIC DISPLAY WITHOUT CLICK -->
      <div class="section">
        <h2 class="section-title">Información de daño</h2>
        <div class="form-grid-2">
          <div class="form-group">
            <label>Tipo de Daño</label>
            <select [(ngModel)]="additionalData.damageType">
              <option value="">Seleccionar</option>
              <option value="MINOR">Menor</option>
              <option value="MAJOR">Mayor</option>
              <option value="TOTAL">Total</option>
            </select>
          </div>
          <div class="form-group">
            <label>Condición</label>
            <select [(ngModel)]="additionalData.damageCondition">
              <option value="">Seleccionar</option>
              <option value="GOOD">Buena</option>
              <option value="REASONABLE">Razonable</option>
              <option value="BAD">Mala</option>
            </select>
          </div>
        </div>

        <!-- Static damage parts display without click modal -->
        <div class="damage-description-static">
          <h3>Partes Afectadas</h3>
          <div class="damage-parts-display">
            <div class="damage-part-card" *ngFor="let part of damageParts">
              <input
                type="checkbox"
                [(ngModel)]="part.selected"
                [id]="'damage-' + part.code"
              />
              <label [for]="'damage-' + part.code">
                <span class="part-code">{{ part.code }}</span>
                <span class="part-name">{{ part.name }}</span>
              </label>
            </div>
          </div>

          <h3 style="margin-top: 2rem;">Ubicación del Daño</h3>
          <div class="damage-parts-display">
            <div class="damage-part-card" *ngFor="let location of damageLocations">
              <input
                type="checkbox"
                [(ngModel)]="location.selected"
                [id]="'location-' + location.code"
              />
              <label [for]="'location-' + location.code">
                <span class="part-code">{{ location.code }}</span>
                <span class="part-name">{{ location.name }}</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button type="button" class="btn-cancel" (click)="cancel()">
          Cancelar
        </button>
        <button type="button" class="btn-submit" (click)="submitClaim()">
          Guardar Reclamo
        </button>
      </div>


    <!-- PIR MODERN FORMAT -->
    <div *ngIf="pirFormat === 'modern'" class="pir-modern">
      <!-- Datos del Reclamo -->
      <div class="section">
        <h2 class="section-title">Datos del Reclamo</h2>
        <div class="form-grid">
          <div class="form-group">
            <label>Estación originador</label>
            <input type="text" [(ngModel)]="claimData.originStation" />
          </div>
          <div class="form-group">
            <label>Fecha</label>
            <input type="date" [(ngModel)]="claimData.originatorDate" />
          </div>
          <div class="form-group">
            <label>Hora</label>
            <input type="time" [(ngModel)]="claimData.originatorTime" />
          </div>
          <div class="form-group">
            <label>Tipo reclamo</label>
            <div class="claim-type-buttons">
              <button
                type="button"
                [class.active]="claimData.claimType === 'AHL'"
                (click)="claimData.claimType = 'AHL'"
              >
                AHL
              </button>
              <button
                type="button"
                [class.active]="claimData.claimType === 'DAMAGED'"
                (click)="claimData.claimType = 'DAMAGED'"
              >
                DAMAGED
              </button>
              <button
                type="button"
                [class.active]="claimData.claimType === 'PILFERED'"
                (click)="claimData.claimType = 'PILFERED'"
              >
                PILFERED
              </button>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label>Estaciones involucradas</label>
          <div class="multi-field-wrapper">
            <span class="code">QD</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addInvolvedStation()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let station of claimData.involvedStations; let i = index">
                  <input
                    type="text"
                    [(ngModel)]="claimData.involvedStations[i]"
                    placeholder="Buscar/seleccionar estación"
                  />
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeInvolvedStation(i)"
                    *ngIf="claimData.involvedStations.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Datos del Pasajero -->
      <div class="section">
        <h2 class="section-title">Datos del Pasajero</h2>
        <div class="form-grid">
          <div class="form-group">
            <label>Nombre(s)</label>
            <div class="input-with-code">
              <span class="code">NM</span>
              <input type="text" [(ngModel)]="passengerData.firstName" />
            </div>
          </div>
          <div class="form-group">
            <label>Apellido paterno</label>
            <input type="text" [(ngModel)]="passengerData.paternalLastName" />
          </div>
          <div class="form-group">
            <label>Apellido materno</label>
            <input type="text" [(ngModel)]="passengerData.maternalLastName" />
          </div>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label>Dirección permanente del Pasajero</label>
            <div class="input-with-code">
              <span class="code">PA</span>
              <textarea [(ngModel)]="passengerData.permanentAddress" rows="2" class="textarea-large"></textarea>
            </div>
          </div>
          <div class="form-group">
            <label>Dirección temporal del Pasajero</label>
            <div class="input-with-code">
              <span class="code">TA</span>
              <textarea [(ngModel)]="passengerData.temporaryAddress" rows="2" class="textarea-large"></textarea>
            </div>
          </div>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label>Teléfono permanente del Pasajero</label>
            <div class="input-with-code">
              <span class="code">PN</span>
              <input type="text" [(ngModel)]="passengerData.permanentPhone" />
            </div>
          </div>
          <div class="form-group">
            <label>Teléfono temporal del Pasajero</label>
            <div class="input-with-code">
              <span class="code">TP</span>
              <input type="text" [(ngModel)]="passengerData.temporaryPhone" />
            </div>
          </div>
          <div class="form-group">
            <label>Correo electrónico del pasajero</label>
            <div class="input-with-code">
              <span class="code">TM</span>
              <input type="email" [(ngModel)]="passengerData.email" />
            </div>
          </div>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label>Nro. de boleto</label>
            <div class="input-with-code">
              <span class="code">TK</span>
              <input type="text" [(ngModel)]="passengerData.ticketNumber" />
            </div>
          </div>
          <div class="form-group">
            <label>Iniciales del pasajero</label>
            <div class="input-with-code">
              <span class="code">IT</span>
              <input type="text" [(ngModel)]="passengerData.initials" />
            </div>
          </div>
          <div class="form-group">
            <label>Número de Pasaporte</label>
            <div class="input-with-code">
              <span class="code">PP</span>
              <input type="text" [(ngModel)]="passengerData.passportNumber" />
            </div>
          </div>
        </div>
      </div>

      <!-- Datos del Equipaje -->
      <div class="section">
        <h2 class="section-title">Datos del Equipaje</h2>
        
        <!-- Fixed bagtags with new multi-field structure -->
        <div class="form-group">
          <label>Aerolíneas - Nro. de ticket</label>
          <div class="multi-field-wrapper">
            <span class="code">TN</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addBagtag()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let bagtag of baggageData.bagtags; let i = index">
                  <input
                    type="text"
                    [(ngModel)]="baggageData.bagtags[i]"
                    placeholder="Número de ticket"
                  />
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeBagtag(i)"
                    *ngIf="baggageData.bagtags.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Fixed routes with new multi-field structure -->
        <div class="form-group">
          <label>Ruta y/o lugar para hacer rastreo</label>
          <div class="multi-field-wrapper">
            <span class="code">RT</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addRoute()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let route of baggageData.routes; let i = index">
                  <input
                    type="text"
                    [(ngModel)]="baggageData.routes[i]"
                    placeholder="Ruta de rastreo"
                  />
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeRoute(i)"
                    *ngIf="baggageData.routes.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Fixed flight info with proper day and month fields -->
        <div class="form-group">
          <label>Nro. de vuelo - Fecha/mes</label>
          <div class="multi-field-wrapper">
            <span class="code">FD</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addFlightInfo()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item flight-item" *ngFor="let flight of baggageData.flightInfo; let i = index">
                  <div class="flight-fields">
                    <input
                      type="text"
                      [(ngModel)]="baggageData.flightInfo[i].flightNumber"
                      placeholder="Número de vuelo"
                      class="flight-number"
                    />
                    <input
                      type="text"
                      [(ngModel)]="baggageData.flightInfo[i].day"
                      placeholder="Día"
                      class="flight-day"
                    />
                    <input
                      type="text"
                      [(ngModel)]="baggageData.flightInfo[i].month"
                      placeholder="Mes"
                      class="flight-month"
                    />
                  </div>
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeFlightInfo(i)"
                    *ngIf="baggageData.flightInfo.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Fixed color type with modal button and new structure -->
        <div class="form-group">
          <label>Color tipo descripción</label>
          <div class="multi-field-wrapper">
            <span class="code">CT</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="openBaggageModal()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let color of baggageData.colors; let i = index">
                  <input
                    type="text"
                    [(ngModel)]="baggageData.colors[i].color"
                    placeholder="Color/tipo/descripción"
                  />
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeColor(i)"
                    *ngIf="baggageData.colors.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Fixed brand with new multi-field structure -->
        <div class="form-group">
          <label>Marca de la maleta</label>
          <div class="multi-field-wrapper">
            <span class="code">BI</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addBrand()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let brand of baggageData.brands; let i = index">
                  <input
                    type="text"
                    [(ngModel)]="baggageData.brands[i]"
                    placeholder="Marca de maleta"
                  />
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeBrand(i)"
                    *ngIf="baggageData.brands.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Fixed content with new multi-field structure -->
        <div class="form-group">
          <label>Contenido</label>
          <div class="multi-field-wrapper">
            <span class="code">CC</span>
            <div class="multi-field-list">
              <button type="button" class="btn-add-field" (click)="addContent()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <div class="multi-field-items">
                <div class="multi-field-item" *ngFor="let content of baggageData.contents; let i = index">
                  <textarea
                    [(ngModel)]="baggageData.contents[i]"
                    rows="2"
                    placeholder="Contenido de maleta"
                  ></textarea>
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeContent(i)"
                    *ngIf="baggageData.contents.length > 1"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label>Peso Facturado</label>
            <div class="input-with-code">
              <span class="code">BW</span>
              <input type="text" [(ngModel)]="baggageData.bagWeight" />
            </div>
          </div>
          <div class="form-group">
            <label>Peso Entregado</label>
            <div class="input-with-code">
              <span class="code">DW</span>
              <input type="text" [(ngModel)]="baggageData.deliveredWeight" />
            </div>
          </div>
          <div class="form-group">
            <label>Diferencia de Peso</label>
            <div class="input-with-code">
              <span class="code">MW</span>
              <input type="text" [(ngModel)]="baggageData.weightDifference" />
            </div>
          </div>
        </div>
      </div>

      <!-- Información del Daño -->
      <div class="section">
        <h2 class="section-title">Información del Daño</h2>
        <button
          type="button"
          class="btn-indicate-damage"
          (click)="openDamageModal()"
        >
          Indicar Daño
        </button>
        <button
          type="button"
          class="btn-indicate-damage secondary"
          (click)="openDamageLocationModal()"
        >
          Ubicación del Daño
        </button>
      </div>

      <div class="form-actions">
        <button type="button" class="btn-cancel" (click)="cancel()">
          Cancelar
        </button>
        <button type="button" class="btn-submit" (click)="submitClaim()">
          Guardar Reclamo
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Damage Location Modal -->
<div class="modal-overlay" *ngIf="showDamageLocationModal" (click)="closeDamageLocationModal()">
  <div class="modal-content modal-damage" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Seleccionar Ubicación del Daño</h3>
      <button class="btn-close" (click)="closeDamageLocationModal()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="modal-body">
      <div class="damage-parts">
        <div
          class="damage-part"
          *ngFor="let location of damageLocations"
          [class.selected]="location.selected"
          (click)="toggleDamageLocation(location)"
        >
          <span class="part-code">{{ location.code }}</span>
          <span class="part-name">{{ location.name }}</span>
        </div>
      </div>
      <button class="btn-save-damage" (click)="closeDamageLocationModal()">
        Guardar Ubicaciones
      </button>
    </div>
  </div>
</div>

<!-- Modal de Selección de Equipaje -->
<div
  class="modal-overlay"
  *ngIf="showBaggageModal"
  (click)="closeBaggageModal()"
>
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Color equipaje</h3>
      <button class="btn-close" (click)="closeBaggageModal()">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="modal-body">
      <div class="baggage-grid">
        <div
          *ngFor="let type of baggageTypes"
          class="baggage-item"
          [class.selected]="selectedBaggageType?.code === type.code"
          (click)="selectBaggageType(type)"
        >
          <div class="baggage-code">{{ type.code }}</div>
          <div class="baggage-image">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="80"
              height="80"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1"
            >
              <rect x="3" y="8" width="18" height="12" rx="2" ry="2"></rect>
              <path d="M7 8V6a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2"></path>
              <line x1="12" y1="14" x2="12" y2="14.01"></line>
            </svg>
          </div>
          <div class="baggage-name">{{ type.name }}</div>
          <div class="baggage-barcode">|||||||||||</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Indicar Daño -->
<div
  class="modal-overlay"
  *ngIf="showDamageModal"
  (click)="closeDamageModal()"
>
  <div class="modal-content modal-damage" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Tipo Daño</h3>
      <button class="btn-close" (click)="closeDamageModal()">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="modal-body">
      <div class="damage-parts">
        <div
          *ngFor="let part of damageParts"
          class="damage-part"
          [class.selected]="part.selected"
          (click)="toggleDamagePart(part)"
        >
          <div class="part-code">{{ part.code }}</div>
          <div class="part-name">{{ part.name }}</div>
        </div>
      </div>

      <button type="button" class="btn-save-damage" (click)="saveDamage()">
        Guardar
      </button>
    </div>
  </div>
</div>

<!-- Modal de Ubicación de Daño -->
<div
  class="modal-overlay"
  *ngIf="showDamageLocationModal"
  (click)="closeDamageLocationModal()"
>
  <div class="modal-content modal-damage" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Ubicación del Daño</h3>
      <button class="btn-close" (click)="closeDamageLocationModal()">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="modal-body">
      <div class="damage-parts">
        <div
          *ngFor="let location of damageLocations"
          class="damage-part"
          [class.selected]="location.selected"
          (click)="toggleDamageLocation(location)"
        >
          <div class="part-code">{{ location.code }}</div>
          <div class="part-name">{{ location.name }}</div>
        </div>
      </div>

      <button
        type="button"
        class="btn-save-damage"
        (click)="closeDamageLocationModal()"
      >
        Guardar
      </button>
    </div>
  </div>
</div>
